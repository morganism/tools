.TH INSTALLER 1 "February 2026" "installer 2.0.0" "User Commands"
."
." Generated by doc_generator.rb v2.0.0
."
.SH NAME
installer \- A standalone manifest-driven installer that reads *.install.json files and performs install, uninstall, check, or list operations for Ruby-based CLI tools.
.SH SYNOPSIS
.B installer.rb --manifest <file.install.json> <action> [options]
.SH DESCRIPTION
This script solves the problem of repeatable, consistent installation of Ruby CLI tools by reading a JSON manifest that declares binaries, man pages, config files, dependencies, and environment requirements. It exists so that each tool does not need its own bespoke installer — instead, any tool can ship a standardized .install.json manifest and this single installer handles everything.
.PP
The script parses CLI options via OptionParser, auto-discovers a lone *.install.json in the current directory if --manifest is not specified, and dispatches to one of four action methods: do_install, do_uninstall, do_check, or do_list. All side-effecting filesystem operations (mkdir, install, cp, rm, chmod) are routed through an act() gate that respects --dry-run mode, --sudo prefixing, and --verbose output. Dependency checking validates Ruby version via Gem::Version, gem availability via Kernel#gem, system binaries via `which`, and environment variables via ENV lookups. ANSI colour output degrades gracefully when stdout is not a TTY.
.SH OPTIONS
.TP
.B -m, --manifest FILE
Path to *.install.json manifest file to operate on
.TP
.B --install
Install binary, man pages, config dirs/files, and verify dependencies
.TP
.B --uninstall
Remove all installed files (except config files which are never auto-deleted)
.TP
.B --check
Verify dependencies and show the install plan without making changes
.TP
.B --list
Print a human-readable summary of the manifest contents
.TP
.B -n, --dry-run
Simulate --install or --uninstall: print every action that would be taken without changing anything
.TP
.B -p, --prefix DIR
Override the install prefix (default: from manifest or /usr/local)
.TP
.B --sudo
Prefix shell commands with sudo for privileged installs
.TP
.B --force
Overwrite existing files that would otherwise block installation
.TP
.B -v, --verbose
Show each command as it is run
.TP
.B -V, --version
Print version and exit
.TP
.B -h, --help
Print usage help and exit
.SH EXAMPLES
.PP
.B Example 1:
.PP
.RS 4
.EX
installer.rb -m mytool.install.json --check
.EE
.RE
.PP
.B Example 2:
.PP
.RS 4
.EX
installer.rb -m mytool.install.json --install --dry-run
.EE
.RE
.PP
.B Example 3:
.PP
.RS 4
.EX
installer.rb -m mytool.install.json --install --sudo
.EE
.RE
.PP
.B Example 4:
.PP
.RS 4
.EX
installer.rb -m mytool.install.json --install --prefix ~/.local
.EE
.RE
.PP
.B Example 5:
.PP
.RS 4
.EX
installer.rb -m mytool.install.json --install --force --verbose
.EE
.RE
.PP
.B Example 6:
.PP
.RS 4
.EX
installer.rb -m mytool.install.json --uninstall --dry-run
.EE
.RE
.PP
.B Example 7:
.PP
.RS 4
.EX
installer.rb -m mytool.install.json --list
.EE
.RE
.SH ENVIRONMENT
.TP
.B HOME
Used to expand ~ in manifest paths via Dir.home
.TP
.B PATH
Used implicitly by `which` when checking system binary dependencies
.SH FILES
.TP
.I *.install.json
JSON manifest file describing binaries, man pages, dependencies, config dirs/files, and post-install notes
.TP
.I installer.rb
The standalone manifest-driven installer script itself
.SH DEPENDENCIES
Requires Ruby 3.0+.
.SS Ruby Gems

.SS System Binaries
.TP
.B install
Package: coreutils. Required
.TP
.B mandb
Package: man-db. Optional
.TP
.B sudo
Package: sudo. Optional
.SH "EXIT STATUS"
.TP
.B 0
Success — action completed (or dry-run finished) without blocking issues
.TP
.B 1
Failure — blocking dependency issues, missing source files, already-installed conflict, or corrupt manifest
.SH BUGS
Shell injection is possible if manifest values contain shell metacharacters, since several commands are built via string interpolation and passed to system(). The fs_rm and fs_mkdir_p helpers do not quote paths. The --sudo flag uses string concatenation rather than a proper privilege escalation mechanism. Config directories created during install are not removed during uninstall.
.SH NOTES
The act() function acts as a universal side-effect gate — in dry-run mode it prints what would happen without yielding the block, which makes the dry-run guarantee structural rather than ad-hoc. Config files are deliberately never auto-removed during uninstall, which is a safety-first design choice that prevents accidental data loss. The manifest discovery logic will auto-select a single *.install.json in the working directory, reducing friction for single-tool repositories.
.SH "SEE ALSO"
.BR install (1),
.BR mandb (8),
.BR makewhatis (8),
.BR gem (1),
.BR which (1),
.BR sudo (8),
.BR jq (1)
.SH AUTHOR
morgan
.PP
Documentation generated by
.BR doc_generator.rb .
