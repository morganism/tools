#!/bin/bash
#
# i make a symlink for each file in ./bin to $HOME/bin
#

HOME_BIN="$HOME/bin"         # the bin dir

echo "linking bin files"
cd bin
for f in $(find . -type f | grep -v $0)
do
  FILE="$(realpath $f)"        # the file in git
  NAME="$(basename $f)"        # st the name 
  TARGET="${HOME_BIN}/${NAME}" # the target 1

  [[ -f "$TARGET" ]] && [[ $(file "$TARGET" | grep "$FILE") ]] && rm "$TARGET" && [[ "$?" = "0" ]] && echo "clean" 

  COMMAND="ln -sf $FILE $TARGET"
  echo "${COMMAND}"
  $COMMAND
done
cd ..
echo "linking dotfiles"
cd dotfiles
for f in $(find . -type f | grep -v $0)
do
  FILE="$(realpath $f)"
  NAME="$(basename $f)"

  if [[ -e "${FILE}" ]]; then
    if [[ -e "${HOME}/${NAME}" ]]; then
      rm "${HOME}/${NAME}"
    fi

    COMMAND="ln -sf $FILE $HOME/$NAME"
    echo "${COMMAND}"
    $COMMAND
  fi
done
